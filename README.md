# Курс "Архитектура ЭВМ и язык Ассемблера"

## Зачетный проект

> **area\_calc** — консольная утилита, вычисляющая площадь замкнутой фигуры, ограниченной тройкой кривых
>
> $f_1(x)=0.35x^2-0.95x+2.7, \; f_2(x)=3x+1, \; f_3(x)=\tfrac1{x+2}$.
>
> Основана на смешанном коде **C99 + NASM SSE2** и демонстрирует сборку многомодульных проектов с CMake.

---

## Возможности

* поиск точек пересечения методом Ньютона;
* адаптивное интегрирование формулой Симпсона;
* вычисление общей площади с заданной точностью;
* счётчики вызовов и число итераций (по ключам CLI);
* кросс‑платформенная сборка (Linux / macOS x86‑64).

---

## Быстрый старт

### 1 · Зависимости

| Пакет       | Минимальная версия |
| ----------- | ------------------ |
| **CMake**   | 3.20               |
| **NASM**    | 2.16               |
| GCC / Clang | поддержка C99      |

> На macOS сборка принудительно идёт под **x86‑64** — это задано в `CMakeLists.txt`.

### 2 · Сборка

```bash
mkdir build && cd build
cmake ..
cmake --build .
```

Проект тестировался и отлаживался на Apple M4 Pro. Работоспособность на других архитектурах не гарантируется и вполне возможно будет требовать доработок CMakeLists.txt.

В каталоге `build/` появится исполняемый файл **`area_calc`**.

### 3 · Запуск

```bash
./area_calc [опции]
```

|                      Опция | Назначение                          |
| -------------------------: | ----------------------------------- |
|                   `-roots` | вывести найденные точки пересечения |
|                   `-iters` | вывести число итераций Ньютона      |
|                   `-calls` | вывести счётчики вызовов функций    |
|   `-test-root f g a b eps` | тестовая проверка `root()`          |
| `-test-integral f a b eps` | тестовая проверка `integral()`      |
|                    `-help` | подсказка по опциям                 |

#### Примеры

```bash
./area_calc                        # только площадь
./area_calc -roots -iters          # +корни и итерации
./area_calc -test-root 1 2 0 1 1e-6        # f1 = f2 на [0,1]
./area_calc -test-integral 3 -1.5 1 1e-5   # ∫ f3(x) dx
```

---

## Структура проекта

```text
msu-asm/
├── CMakeLists.txt         # правила сборки
├── main.c                 # точка входа, CLI
├── newton.c  / newton.h   # метод Ньютона
├── simpson.c / simpson.h  # формула Симпсона
├── wrappers.c             # обёртки‑счётчики
├── functions.asm          # f1, f2, f3 + производные (SSE2)
└── docs/
    ├── ia32_amd64_comparison.md   # отличие IA‑32 и AMD64 ABI
    └── ia32_amd64_comparison.pdf  
    └── msu_asm_report.md          # подробный отчёт по задаче
    └── msu_asm_report.pdf
    └── plot1.png
    └── plot2.png
    └── Постановка задания 6.pdf
    
```

---

## Алгоритмы

* **Метод Ньютона** — поиск корня $f(x)=g(x)$ с контролем выхода за границы отрезка;
* **Адаптивный Симпсон** — итеративная формула без кэша, критерий сходимости $|S_{new}-S| < 15\,\varepsilon$.

Подробности приведены в документации (ссылки ниже).

---

## Документация

* **Задача:** [`docs/Постановка задания 6.pdf`](docs/Постановка%20задания%206.pdf)
* **Технический отчёт:** [`docs/msu_asm_report.md`](docs/msu_asm_report.md)
* **IA‑32 vs AMD64 ABI:** [`docs/ia32_amd64_comparison.md`](docs/ia32_amd64_comparison.md)
